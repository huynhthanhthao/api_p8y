//////////////////////////////////////////////////////////////////////////////////////////////
// DO NOT MODIFY THIS FILE                                                                  //
// This file is automatically generated by ZenStack CLI and should not be manually updated. //
//////////////////////////////////////////////////////////////////////////////////////////////

datasource db {
  provider = "postgresql"
  url      = env("DB_URL")
}

generator client {
  provider      = "prisma-client-js"
  engineType    = "binary"
  binaryTargets = ["native", "debian-openssl-1.1.x", "debian-openssl-3.0.x"]
}

generator dbml {
  provider            = "prisma-dbml-generator"
  output              = "./dbml"
  projectName         = "IIT P8Y"
  projectDatabaseType = "PostgreSQL"
  outputName          = "IIT_P8Y.dbml"
}

model Store {
  code           String          @id() @unique() @db.VarChar(50)
  name           String          @db.VarChar(255)
  logo           String?         @db.VarChar(500)
  expiryAt       DateTime?       @map("expiry_at") @db.Timestamptz(6)
  branches       Branch[]
  users          User[]
  customers      Customer[]
  customerGroups CustomerGroup[]
  suppliers      Supplier[]
  supplierGroups SupplierGroup[]

  @@map("stores")
}

model Branch {
  id                String             @id() @default(uuid()) @db.Uuid()
  createdAt         DateTime           @default(now()) @map("created_at") @db.Timestamptz(6)
  createdBy         String?            @map("created_by") @db.Uuid()
  updatedAt         DateTime           @updatedAt() @map("updated_at") @db.Timestamptz(6)
  updatedBy         String?            @map("updated_by") @db.Uuid()
  deletedAt         DateTime?          @map("deleted_at") @db.Timestamptz(6)
  deletedBy         String?            @map("deleted_by") @db.Uuid()
  name              String             @db.VarChar(255)
  email             String?            @db.VarChar(255)
  phone             String?            @db.VarChar(20)
  storeCode         String             @map("store_code") @db.VarChar(50)
  wardCode          Int?               @map("ward_code")
  provinceCode      Int?               @map("province_code")
  ward              Ward?              @relation(fields: [wardCode], references: [code], onDelete: SetNull)
  province          Province?          @relation(fields: [provinceCode], references: [code], onDelete: SetNull)
  store             Store              @relation(fields: [storeCode], references: [code], onDelete: Cascade)
  users             User[]
  productGroups     ProductGroup[]
  invoices          Invoice[]
  stockTransactions StockTransaction[]
  products          Product[]

  @@map("branches")
}

model User {
  id        String    @id() @default(uuid()) @db.Uuid()
  createdAt DateTime  @default(now()) @map("created_at") @db.Timestamptz(6)
  createdBy String?   @map("created_by") @db.Uuid()
  updatedAt DateTime  @updatedAt() @map("updated_at") @db.Timestamptz(6)
  updatedBy String?   @map("updated_by") @db.Uuid()
  deletedAt DateTime? @map("deleted_at") @db.Timestamptz(6)
  deletedBy String?   @map("deleted_by") @db.Uuid()
  firstName String    @map("first_name") @db.VarChar(100)
  lastName  String?   @default("") @map("last_name") @db.VarChar(100)
  phone     String    @db.VarChar(20)
  storeCode String    @map("store_code")
  status    String    @db.VarChar(50)
  type      String    @db.VarChar(50)
  password  String    @db.VarChar(255)
  email     String?   @default("") @db.VarChar(255)
  lastLogin DateTime? @map("last_login") @db.Timestamptz(6)
  wareCode  String?   @map("ware_code") @db.VarChar(50)
  address   String?   @default("") @db.VarChar(500)
  avatarUrl String?   @default("") @db.VarChar(255)
  roles     Role[]
  branches  Branch[]
  store     Store     @relation(fields: [storeCode], references: [code])

  @@unique([storeCode, phone], name: "idx_store_phone")
  @@unique([storeCode, email], name: "idx_store_email")
  @@map("users")
}

model Role {
  id          String       @id() @default(uuid()) @db.Uuid()
  createdAt   DateTime     @default(now()) @map("created_at") @db.Timestamptz(6)
  createdBy   String?      @map("created_by") @db.Uuid()
  updatedAt   DateTime     @updatedAt() @map("updated_at") @db.Timestamptz(6)
  updatedBy   String?      @map("updated_by") @db.Uuid()
  deletedAt   DateTime?    @map("deleted_at") @db.Timestamptz(6)
  deletedBy   String?      @map("deleted_by") @db.Uuid()
  name        String       @db.VarChar(255)
  users       User[]
  permissions Permission[]

  @@map("roles")
}

model Permission {
  code      String          @id() @db.VarChar(50)
  name      String          @db.VarChar(255)
  roleId    String          @map("role_id") @db.Uuid()
  groupCode String          @map("group_code") @db.VarChar(50)
  role      Role            @relation(fields: [roleId], references: [id], onDelete: Cascade)
  group     PermissionGroup @relation(fields: [groupCode], references: [code])

  @@map("permissions")
}

model PermissionGroup {
  code        String       @id() @db.VarChar(50)
  name        String       @db.VarChar(255)
  permissions Permission[]

  @@map("permission_groups")
}

model ProductGroup {
  id        String         @id() @default(uuid()) @db.Uuid()
  createdAt DateTime       @default(now()) @map("created_at") @db.Timestamptz(6)
  createdBy String?        @map("created_by") @db.Uuid()
  updatedAt DateTime       @updatedAt() @map("updated_at") @db.Timestamptz(6)
  updatedBy String?        @map("updated_by") @db.Uuid()
  deletedAt DateTime?      @map("deleted_at") @db.Timestamptz(6)
  deletedBy String?        @map("deleted_by") @db.Uuid()
  name      String         @db.VarChar(255)
  code      String         @db.VarChar(50)
  parentId  String?        @map("parent_id") @db.Uuid()
  branchId  String         @map("branch_id") @db.Uuid()
  branch    Branch         @relation(fields: [branchId], references: [id])
  parent    ProductGroup?  @relation("ProductGroupToParent", fields: [parentId], references: [id])
  children  ProductGroup[] @relation("ProductGroupToParent")
  products  Product[]

  @@map("product_groups")
}

model Product {
  id             String          @id() @default(uuid()) @db.Uuid()
  createdAt      DateTime        @default(now()) @map("created_at") @db.Timestamptz(6)
  createdBy      String?         @map("created_by") @db.Uuid()
  updatedAt      DateTime        @updatedAt() @map("updated_at") @db.Timestamptz(6)
  updatedBy      String?         @map("updated_by") @db.Uuid()
  deletedAt      DateTime?       @map("deleted_at") @db.Timestamptz(6)
  deletedBy      String?         @map("deleted_by") @db.Uuid()
  name           String          @db.VarChar(255)
  code           String          @db.VarChar(50)
  productGroupId String          @map("group_id") @db.Uuid()
  branchId       String          @map("branch_id") @db.Uuid()
  barcode        String?         @default("") @db.VarChar(100)
  shortName      String?         @default("") @map("short_name") @db.VarChar(100)
  description    String?         @default("") @db.Text()
  salePrice      Float?          @default(0) @map("sale_price")
  costPrice      Float?          @default(0) @map("cost_price")
  type           String?         @default("PRODUCT") @db.VarChar(50)
  minStock       Float?          @default(0) @map("min_stock")
  maxStock       Float?          @default(999999999) @map("max_stock")
  branch         Branch          @relation(fields: [branchId], references: [id])
  productGroup   ProductGroup?   @relation(fields: [productGroupId], references: [id])
  productWeight  ProductWeight?
  medicineInfo   MedicineInfo?
  productUnits   ProductUnit[]
  stockLocations StockLocation[]
  invoiceItems   InvoiceItem[]
  stockCards     StockCard[]
  stockItems     StockItem[]

  @@map("products")
}

model Supplier {
  id              String         @id() @default(uuid()) @db.Uuid()
  createdAt       DateTime       @default(now()) @map("created_at") @db.Timestamptz(6)
  createdBy       String?        @map("created_by") @db.Uuid()
  updatedAt       DateTime       @updatedAt() @map("updated_at") @db.Timestamptz(6)
  updatedBy       String?        @map("updated_by") @db.Uuid()
  deletedAt       DateTime?      @map("deleted_at") @db.Timestamptz(6)
  deletedBy       String?        @map("deleted_by") @db.Uuid()
  name            String         @db.VarChar(255)
  code            String         @db.VarChar(50)
  phone           String?        @db.VarChar(20)
  email           String?        @db.VarChar(100)
  tax             String?        @db.VarChar(50)
  supplierGroupId String?        @map("supplier_group_id") @db.Uuid()
  storeCode       String         @map("store_code") @db.VarChar(50)
  branchId        String         @map("branch_id") @db.Uuid()
  supplierGroup   SupplierGroup? @relation(fields: [supplierGroupId], references: [id])
  store           Store          @relation(fields: [storeCode], references: [code])

  @@map("suppliers")
}

model SupplierGroup {
  id        String     @id() @default(uuid()) @db.Uuid()
  createdAt DateTime   @default(now()) @map("created_at") @db.Timestamptz(6)
  createdBy String?    @map("created_by") @db.Uuid()
  updatedAt DateTime   @updatedAt() @map("updated_at") @db.Timestamptz(6)
  updatedBy String?    @map("updated_by") @db.Uuid()
  deletedAt DateTime?  @map("deleted_at") @db.Timestamptz(6)
  deletedBy String?    @map("deleted_by") @db.Uuid()
  name      String     @db.VarChar(255)
  note      String?    @db.VarChar(500)
  storeCode String     @map("store_code") @db.VarChar(50)
  suppliers Supplier[]
  store     Store      @relation(fields: [storeCode], references: [code])

  @@map("supplier_groups")
}

model StockLocation {
  id        String    @id() @default(uuid()) @db.Uuid()
  createdAt DateTime  @default(now()) @map("created_at") @db.Timestamptz(6)
  createdBy String?   @map("created_by") @db.Uuid()
  updatedAt DateTime  @updatedAt() @map("updated_at") @db.Timestamptz(6)
  updatedBy String?   @map("updated_by") @db.Uuid()
  deletedAt DateTime? @map("deleted_at") @db.Timestamptz(6)
  deletedBy String?   @map("deleted_by") @db.Uuid()
  name      String    @db.VarChar(255)
  products  Product[]

  @@map("stock_locations")
}

model ProductWeight {
  unit      String? @default("KG") @db.VarChar(20)
  value     Float?  @default(0)
  productId String  @unique() @map("product_id") @db.Uuid()
  product   Product @relation(fields: [productId], references: [id])

  @@map("product_weights")
}

model MedicineInfo {
  id             String       @id() @default(uuid()) @db.Uuid()
  createdAt      DateTime     @default(now()) @map("created_at") @db.Timestamptz(6)
  createdBy      String?      @map("created_by") @db.Uuid()
  updatedAt      DateTime     @updatedAt() @map("updated_at") @db.Timestamptz(6)
  updatedBy      String?      @map("updated_by") @db.Uuid()
  deletedAt      DateTime?    @map("deleted_at") @db.Timestamptz(6)
  deletedBy      String?      @map("deleted_by") @db.Uuid()
  regNumber      String       @db.VarChar(100)
  ingredient     String       @db.VarChar(255)
  dosage         String       @db.VarChar(100)
  route          String       @db.VarChar(100)
  package        String       @db.VarChar(255)
  origin         String       @db.VarChar(100)
  countryCode    String?      @map("country_code") @db.VarChar(10)
  manufacturerId String       @map("manufacturer_id") @db.Uuid()
  productId      String       @unique() @db.Uuid()
  country        Country?     @relation(fields: [countryCode], references: [code])
  product        Product      @relation(fields: [productId], references: [id])
  manufacturer   Manufacturer @relation(fields: [manufacturerId], references: [id])

  @@map("medicine_infos")
}

model Manufacturer {
  id        String         @id() @default(uuid()) @db.Uuid()
  createdAt DateTime       @default(now()) @map("created_at") @db.Timestamptz(6)
  createdBy String?        @map("created_by") @db.Uuid()
  updatedAt DateTime       @updatedAt() @map("updated_at") @db.Timestamptz(6)
  updatedBy String?        @map("updated_by") @db.Uuid()
  deletedAt DateTime?      @map("deleted_at") @db.Timestamptz(6)
  deletedBy String?        @map("deleted_by") @db.Uuid()
  name      String         @db.VarChar(255)
  country   String?        @db.VarChar(100)
  medicines MedicineInfo[]

  @@map("manufacturers")
}

model Country {
  code          String         @unique() @db.VarChar(10)
  name          String         @db.VarChar(100)
  medicineInfos MedicineInfo[]

  @@map("countries")
}

model ProductUnit {
  id         String    @id() @default(uuid()) @db.Uuid()
  createdAt  DateTime  @default(now()) @map("created_at") @db.Timestamptz(6)
  createdBy  String?   @map("created_by") @db.Uuid()
  updatedAt  DateTime  @updatedAt() @map("updated_at") @db.Timestamptz(6)
  updatedBy  String?   @map("updated_by") @db.Uuid()
  deletedAt  DateTime? @map("deleted_at") @db.Timestamptz(6)
  deletedBy  String?   @map("deleted_by") @db.Uuid()
  name       String    @db.VarChar(50)
  isBase     Boolean   @default(false)
  conversion Float     @default(1)
  sku        String?   @db.VarChar(100)
  barcode    String?   @db.VarChar(100)
  costPrice  Float?    @default(0)
  salePrice  Float?    @default(0)
  isSale     Boolean   @default(true) @map("is_sale")
  productId  String    @map("product_id") @db.Uuid()
  product    Product   @relation(fields: [productId], references: [id])

  @@map("product_units")
}

model InvoiceItem {
  id            String    @id() @default(uuid()) @db.Uuid()
  createdAt     DateTime  @default(now()) @map("created_at") @db.Timestamptz(6)
  createdBy     String?   @map("created_by") @db.Uuid()
  updatedAt     DateTime  @updatedAt() @map("updated_at") @db.Timestamptz(6)
  updatedBy     String?   @map("updated_by") @db.Uuid()
  deletedAt     DateTime? @map("deleted_at") @db.Timestamptz(6)
  deletedBy     String?   @map("deleted_by") @db.Uuid()
  qty           Float     @default(1) @map("quantity")
  salePrice     Float     @default(0) @map("sale_price")
  productName   String?   @map("product_name") @db.VarChar(255)
  discountValue Float?    @default(0) @map("discount_value")
  discountType  String?   @map("discount_type") @db.VarChar(10)
  note          String?   @map("note") @db.VarChar(500)
  productId     String    @map("product_id") @db.Uuid()
  invoiceId     String    @map("invoice_id") @db.Uuid()
  product       Product   @relation(fields: [productId], references: [id])
  invoice       Invoice   @relation(fields: [invoiceId], references: [id])

  @@map("invoice_items")
}

model Invoice {
  id            String         @id() @default(uuid()) @db.Uuid()
  createdAt     DateTime       @default(now()) @map("created_at") @db.Timestamptz(6)
  createdBy     String?        @map("created_by") @db.Uuid()
  updatedAt     DateTime       @updatedAt() @map("updated_at") @db.Timestamptz(6)
  updatedBy     String?        @map("updated_by") @db.Uuid()
  deletedAt     DateTime?      @map("deleted_at") @db.Timestamptz(6)
  deletedBy     String?        @map("deleted_by") @db.Uuid()
  code          String         @map("code") @db.VarChar(50)
  status        String         @map("status") @db.VarChar(20)
  discountValue Float?         @default(0) @map("discount_value")
  discountType  String?        @map("discount_type") @db.VarChar(10)
  note          String?        @map("note") @db.Text()
  customerId    String?        @map("customer_id") @db.Uuid()
  transportId   String?        @unique() @map("transport_id") @db.Uuid()
  branchId      String         @map("branch_id") @db.Uuid()
  branch        Branch         @relation(fields: [branchId], references: [id])
  transport     TransportInfo?
  deliveryInfo  DeliveryInfo?
  customer      Customer?      @relation(fields: [customerId], references: [id])
  invoiceItems  InvoiceItem[]

  @@unique([code, branchId])
  @@map("invoices")
}

model TransportInfo {
  invoiceId     String   @id() @unique() @map("invoice_id") @db.Uuid()
  weight        Float?   @default(0) @map("weight")
  length        Float?   @default(0) @map("length")
  width         Float?   @default(0) @map("width")
  height        Float?   @default(0) @map("height")
  weightUnit    String?  @default("gram") @map("weight_unit")
  dimensionUnit String?  @default("cm") @map("dimension_unit")
  note          String?  @map("note") @db.VarChar(500)
  invoice       Invoice? @relation(fields: [invoiceId], references: [id])

  @@map("transport_infos")
}

model DeliveryInfo {
  invoiceId String   @id() @unique() @map("invoice_id") @db.Uuid()
  address   String?  @map("address") @db.VarChar(255)
  ward      String?  @map("ward") @db.VarChar(100)
  district  String?  @map("district") @db.VarChar(100)
  province  String?  @map("province") @db.VarChar(100)
  note      String?  @map("note") @db.Text()
  invoice   Invoice? @relation(fields: [invoiceId], references: [id])

  @@map("delivery_infos")
}

model Customer {
  id                String         @id() @default(uuid()) @db.Uuid()
  createdAt         DateTime       @default(now()) @map("created_at") @db.Timestamptz(6)
  createdBy         String?        @map("created_by") @db.Uuid()
  updatedAt         DateTime       @updatedAt() @map("updated_at") @db.Timestamptz(6)
  updatedBy         String?        @map("updated_by") @db.Uuid()
  deletedAt         DateTime?      @map("deleted_at") @db.Timestamptz(6)
  deletedBy         String?        @map("deleted_by") @db.Uuid()
  name              String         @db.VarChar(255)
  code              String         @unique() @db.VarChar(50)
  email             String?        @db.VarChar(255)
  phone             String?        @db.VarChar(20)
  birthday          DateTime?      @db.Date()
  gender            String?        @db.VarChar(20)
  avatarUrl         String?        @map("avatar_url") @db.VarChar(500)
  note              String?        @db.VarChar(500)
  invBuyerName      Boolean?       @map("inv_buyer_name")
  invTaxCode        String?        @map("inv_tax_code") @db.VarChar(50)
  invAddress        String?        @map("inv_address") @db.VarChar(500)
  invProvince       String?        @map("inv_province") @db.VarChar(100)
  invWard           String?        @map("inv_ward") @db.VarChar(100)
  invIdentityNumber String?        @map("inv_identity_number") @db.VarChar(50)
  invEmail          String?        @map("inv_email") @db.VarChar(255)
  invPhone          String?        @map("inv_phone") @db.VarChar(20)
  invBankName       String?        @map("inv_bank_name") @db.VarChar(255)
  invBankAccount    String?        @map("inv_bank_account") @db.VarChar(50)
  invBudgetUnitCode String?        @map("inv_budget_unit_code") @db.VarChar(50)
  customerGroup     CustomerGroup? @relation(fields: [customerGroupId], references: [id])
  customerGroupId   String?        @map("customer_group_id") @db.Uuid()
  stores            Store[]
  invoices          Invoice[]

  @@map("customers")
}

model CustomerGroup {
  id           String     @id() @default(uuid()) @db.Uuid()
  createdAt    DateTime   @default(now()) @map("created_at") @db.Timestamptz(6)
  createdBy    String?    @map("created_by") @db.Uuid()
  updatedAt    DateTime   @updatedAt() @map("updated_at") @db.Timestamptz(6)
  updatedBy    String?    @map("updated_by") @db.Uuid()
  deletedAt    DateTime?  @map("deleted_at") @db.Timestamptz(6)
  deletedBy    String?    @map("deleted_by") @db.Uuid()
  name         String     @db.VarChar(255)
  discount     Float?     @db.DoublePrecision()
  discountType String?    @db.VarChar(50)
  stores       Store[]
  customers    Customer[]

  @@map("customer_groups")
}

model StockCard {
  id               String            @id() @default(uuid()) @db.Uuid()
  createdAt        DateTime          @default(now()) @map("created_at") @db.Timestamptz(6)
  createdBy        String?           @map("created_by") @db.Uuid()
  updatedAt        DateTime          @updatedAt() @map("updated_at") @db.Timestamptz(6)
  updatedBy        String?           @map("updated_by") @db.Uuid()
  deletedAt        DateTime?         @map("deleted_at") @db.Timestamptz(6)
  deletedBy        String?           @map("deleted_by") @db.Uuid()
  productId        String            @db.Uuid()
  transId          String?           @db.Uuid()
  orderId          String?           @db.Uuid()
  type             String            @db.VarChar(20)
  inQty            Float             @default(0)
  outQty           Float             @default(0)
  balance          Float             @default(0)
  note             String?           @db.Text()
  product          Product           @relation(fields: [productId], references: [id])
  stockTransaction StockTransaction? @relation(fields: [transId], references: [id])

  @@map("stock_cards")
}

model StockTransaction {
  id         String      @id() @default(uuid()) @db.Uuid()
  createdAt  DateTime    @default(now()) @map("created_at") @db.Timestamptz(6)
  createdBy  String?     @map("created_by") @db.Uuid()
  updatedAt  DateTime    @updatedAt() @map("updated_at") @db.Timestamptz(6)
  updatedBy  String?     @map("updated_by") @db.Uuid()
  deletedAt  DateTime?   @map("deleted_at") @db.Timestamptz(6)
  deletedBy  String?     @map("deleted_by") @db.Uuid()
  code       String      @unique() @db.VarChar(50)
  type       String      @db.VarChar(20)
  status     String      @default("DRAFT") @db.VarChar(20)
  transDate  DateTime    @default(now())
  note       String?     @db.Text()
  branchId   String      @map("branch_id") @db.Uuid()
  branch     Branch      @relation(fields: [branchId], references: [id])
  items      StockItem[]
  stockCards StockCard[]

  @@map("stock_transactions")
}

model StockItem {
  id                String           @id() @default(uuid()) @db.Uuid()
  createdAt         DateTime         @default(now()) @map("created_at") @db.Timestamptz(6)
  createdBy         String?          @map("created_by") @db.Uuid()
  updatedAt         DateTime         @updatedAt() @map("updated_at") @db.Timestamptz(6)
  updatedBy         String?          @map("updated_by") @db.Uuid()
  deletedAt         DateTime?        @map("deleted_at") @db.Timestamptz(6)
  deletedBy         String?          @map("deleted_by") @db.Uuid()
  transId           String           @db.Uuid()
  productId         String           @db.Uuid()
  quantity          Float            @default(0)
  unitPrice         Float            @default(0)
  total             Float            @default(0)
  batchCode         String?          @db.VarChar(50)
  product           Product          @relation(fields: [productId], references: [id])
  stockTransactions StockTransaction @relation(fields: [transId], references: [id], onDelete: Cascade)

  @@map("stock_items")
}

model Ward {
  code          Int      @id()
  name          String   @db.VarChar(100)
  codeName      String   @map("code_name") @db.VarChar(50)
  divisionType  String   @map("division_type") @db.VarChar(50)
  shortCodeName String   @map("short_code_name") @db.VarChar(50)
  provinceCode  Int      @map("province_code")
  province      Province @relation(fields: [provinceCode], references: [code])
  branches      Branch[]

  @@map("wards")
}

model Province {
  code         Int      @id()
  name         String   @db.VarChar(100)
  divisionType String   @map("division_type") @db.VarChar(50)
  codeName     String   @map("code_name") @db.VarChar(50)
  phoneCode    String   @map("phone_code") @db.VarChar(50)
  branches     Branch[]
  wards        Ward[]

  @@map("provinces")
}
