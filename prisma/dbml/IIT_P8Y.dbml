//// ------------------------------------------------------
//// THIS FILE WAS AUTOMATICALLY GENERATED (DO NOT MODIFY)
//// ------------------------------------------------------

Project "IIT P8Y" {
  database_type: 'PostgreSQL'
  Note: ''
}

Table stores {
  code String [pk]
  name String [not null]
  logo String
  expiryAt DateTime
  branches branches [not null]
  users users [not null]
  customers customers [not null]
  customerGroups customer_groups [not null]
}

Table branches {
  id String [pk]
  createdAt DateTime [default: `now()`, not null]
  createdBy String
  updatedAt DateTime [not null]
  updatedBy String
  deletedAt DateTime
  deletedBy String
  name String [not null]
  email String [default: '']
  phone String [default: '']
  storeCode String [not null]
  wardCode Int
  provinceCode Int
  ward wards
  province provinces
  store stores [not null]
  users users [not null]
  productGroups product_groups [not null]
  invoices invoices [not null]
  stockTransactions stock_transactions [not null]
  products products [not null]
  suppliers suppliers [not null]
  supplierGroups supplier_groups [not null]
  manufacturers manufacturers [not null]
  productLocations stock_locations [not null]
  medicineRoutes medicine_routes [not null]
  paymentMethods payment_methods [not null]
  productLots product_lots [not null]
}

Table users {
  id String [pk]
  createdAt DateTime [default: `now()`, not null]
  createdBy String
  updatedAt DateTime [not null]
  updatedBy String
  deletedAt DateTime
  deletedBy String
  firstName String [not null]
  lastName String [default: '']
  phone String [not null]
  storeCode String [not null]
  status String [not null]
  type String [not null]
  password String [not null]
  email String [default: '']
  lastLogin DateTime
  wareCode String
  address String [default: '']
  avatarUrl String [default: '']
  store stores [not null]
  roles roles [not null]
  branches branches [not null]
  createdInvoices invoices [not null]
  updatedInvoices invoices [not null]
  createdStockTransactions stock_transactions [not null]
  updatedStockTransactions stock_transactions [not null]

  indexes {
    (storeCode, phone) [unique]
    (storeCode, email) [unique]
  }
}

Table roles {
  id String [pk]
  createdAt DateTime [default: `now()`, not null]
  createdBy String
  updatedAt DateTime [not null]
  updatedBy String
  deletedAt DateTime
  deletedBy String
  name String [not null]
  users users [not null]
  permissions permissions [not null]
}

Table permissions {
  code String [pk]
  name String [not null]
  roleId String [not null]
  groupCode String [not null]
  role roles [not null]
  group permission_groups [not null]
}

Table permission_groups {
  code String [pk]
  name String [not null]
  permissions permissions [not null]
}

Table payment_methods {
  code String [not null]
  branchId String [not null]
  isActive Boolean [not null, default: false]
  bankAccountHolder String
  bankBin String
  bankShortName String
  bankAccount String
  invoices invoices [not null]
  branch branches
  createdAt DateTime [default: `now()`, not null]
  createdBy String
  updatedBy String
  updatedAt DateTime [not null]

  indexes {
    (code, branchId) [unique]
  }
}

Table invoices {
  id String [pk]
  createdAt DateTime [default: `now()`, not null]
  createdBy String
  updatedAt DateTime [not null]
  updatedBy String
  deletedAt DateTime
  deletedBy String
  code String [not null]
  status String [not null]
  discountValue Float [default: 0]
  discountType String [default: 'VALUE']
  note String
  paymentMethodCode String
  customerId String
  transportId String [unique]
  branchId String [not null]
  paymentMethod payment_methods
  branch branches [not null]
  transport transport_infos
  deliveryInfo delivery_infos
  customer customers
  invoiceItems invoice_items [not null]
  creator users
  updater users

  indexes {
    (code, branchId) [unique]
  }
}

Table invoice_items {
  id String [pk]
  createdAt DateTime [default: `now()`, not null]
  createdBy String
  updatedAt DateTime [not null]
  updatedBy String
  deletedAt DateTime
  deletedBy String
  salePrice Float [not null, default: 0]
  costPrice Float [not null, default: 0]
  discountValue Float [default: 0]
  discountType String [default: 'VALUE']
  note String
  productId String [not null]
  invoiceId String [not null]
  product products [not null]
  invoice invoices [not null]
  invoiceItemLots invoice_item_lots [not null]
}

Table invoice_item_lots {
  id String [pk]
  invoiceItemId String [not null]
  productLotId String [not null]
  quantity Float [not null, default: 1]
  createdAt DateTime [default: `now()`, not null]
  updatedAt DateTime [not null]
  invoiceItem invoice_items
  productLot product_lots
}

Table products {
  id String [pk]
  createdAt DateTime [default: `now()`, not null]
  createdBy String
  updatedAt DateTime [not null]
  updatedBy String
  deletedAt DateTime
  deletedBy String
  branchId String [not null]
  name String [not null]
  code String [not null]
  productGroupId String [not null]
  type String [not null, default: 'PRODUCT']
  barcode String [default: '']
  shortName String [default: '']
  description String [default: '']
  isDirectSale Boolean [not null, default: true]
  salePrice Float [default: 0]
  costPrice Float [default: 0]
  isLotEnabled Boolean [not null, default: false]
  isStockEnabled Boolean [not null, default: false]
  stockQuantity Float
  minStock Float [default: 0]
  maxStock Float [default: 999999999]
  package String
  country String
  manufacturerId String
  parentId String
  unitName String
  conversion Float [default: 1]
  branch branches [not null]
  manufacturer manufacturers
  productGroup product_groups
  productWeight product_weights
  medicineInfo medicine_infos
  productLocations stock_locations [not null]
  invoiceItems invoice_items [not null]
  stockCards stock_cards [not null]
  stockItems stock_items [not null]
  productLots product_lots [not null]
  photos files [not null]
  parent products
  variants products [not null]

  indexes {
    (branchId, code) [unique]
  }
}

Table product_groups {
  id String [pk]
  createdAt DateTime [default: `now()`, not null]
  createdBy String
  updatedAt DateTime [not null]
  updatedBy String
  deletedAt DateTime
  deletedBy String
  name String [not null]
  parentId String
  branchId String [not null]
  branch branches [not null]
  parent product_groups
  children product_groups [not null]
  products products [not null]
}

Table suppliers {
  id String [pk]
  createdAt DateTime [default: `now()`, not null]
  createdBy String
  updatedAt DateTime [not null]
  updatedBy String
  deletedAt DateTime
  deletedBy String
  name String [not null]
  code String [not null]
  phone String
  email String
  tax String [default: '']
  supplierGroupId String
  branchId String [not null]
  supplierGroup supplier_groups
  branch branches [not null]
  stockTransaction stock_transactions [not null]

  indexes {
    (code, branchId) [unique]
    (phone, branchId) [unique]
  }
}

Table supplier_groups {
  id String [pk]
  createdAt DateTime [default: `now()`, not null]
  createdBy String
  updatedAt DateTime [not null]
  updatedBy String
  deletedAt DateTime
  deletedBy String
  name String [not null]
  note String [default: '']
  branchId String [not null]
  suppliers suppliers [not null]
  branch branches [not null]
}

Table stock_transactions {
  id String [pk]
  createdAt DateTime [default: `now()`, not null]
  createdBy String
  updatedAt DateTime [not null]
  updatedBy String
  deletedAt DateTime
  deletedBy String
  branchId String [not null]
  status String [not null, default: 'PENDING']
  code String [not null]
  type String [not null]
  discountType String [default: 'VALUE']
  discountValue Float [default: 0]
  supplierId String
  supplier suppliers
  note String
  transactedAt DateTime [default: `now()`]
  branch branches [not null]
  items stock_items [not null]
  stockCards stock_cards [not null]
  creator users
  updater users

  indexes {
    (code, branchId) [unique]
  }
}

Table stock_items {
  id String [pk]
  createdAt DateTime [default: `now()`, not null]
  createdBy String
  updatedAt DateTime [not null]
  updatedBy String
  deletedAt DateTime
  deletedBy String
  transId String [not null]
  productId String [not null]
  quantity Float [not null, default: 0]
  unitPrice Float [not null, default: 0]
  total Float [not null, default: 0]
  discountType String [default: 'VALUE']
  discountValue Float [default: 0]
  supplierId String
  stockItemLots stock_item_lots [not null]
  product products [not null]
  stockTransactions stock_transactions [not null]
}

Table stock_item_lots {
  id String [pk]
  stockItemId String [not null]
  productLotId String [not null]
  quantity Float [not null, default: 1]
  createdAt DateTime [default: `now()`, not null]
  updatedAt DateTime [not null]
  stockItem stock_items
  productLot product_lots
}

Table product_lots {
  id String [pk]
  createdAt DateTime [default: `now()`, not null]
  createdBy String
  updatedAt DateTime [not null]
  updatedBy String
  deletedAt DateTime
  deletedBy String
  productId String [not null]
  name String [not null]
  expiryAt DateTime [not null]
  quantity Float [not null, default: 0]
  branchId String [not null]
  branch branches [not null]
  product products [not null]
  invoiceItemLots invoice_item_lots [not null]
  stockItemLots stock_item_lots [not null]
}

Table stock_cards {
  id String [pk]
  createdAt DateTime [default: `now()`, not null]
  createdBy String
  updatedAt DateTime [not null]
  updatedBy String
  deletedAt DateTime
  deletedBy String
  productId String [not null]
  transId String
  orderId String
  type String [not null]
  inQty Float [not null, default: 0]
  outQty Float [not null, default: 0]
  balance Float [not null, default: 0]
  note String
  product products [not null]
  stockTransaction stock_transactions
}

Table stock_locations {
  id String [pk]
  createdAt DateTime [default: `now()`, not null]
  createdBy String
  updatedAt DateTime [not null]
  updatedBy String
  deletedAt DateTime
  deletedBy String
  name String [not null]
  branchId String [not null]
  branch branches [not null]
  products products [not null]
}

Table product_weights {
  unit String [default: 'KG']
  value Float [default: 0]
  productId String [unique, not null]
  product products [not null]
}

Table medicine_infos {
  productId String [unique, not null]
  regNumber String
  ingredient String
  dosage String
  routeId String
  product products
  route medicine_routes
}

Table medicine_routes {
  id String [pk]
  createdAt DateTime [default: `now()`, not null]
  createdBy String
  updatedAt DateTime [not null]
  updatedBy String
  deletedAt DateTime
  deletedBy String
  name String [not null]
  branchId String [not null]
  medicines medicine_infos [not null]
  branch branches [not null]
}

Table manufacturers {
  id String [pk]
  createdAt DateTime [default: `now()`, not null]
  createdBy String
  updatedAt DateTime [not null]
  updatedBy String
  deletedAt DateTime
  deletedBy String
  name String [not null]
  branchId String [not null]
  products products [not null]
  branch branches [not null]
}

Table files {
  id String [pk]
  createdAt DateTime [default: `now()`, not null]
  createdBy String
  updatedAt DateTime [not null]
  updatedBy String
  deletedAt DateTime
  deletedBy String
  filename String [not null]
  originalName String [not null]
  mimetype String [not null]
  size Int [not null]
  path String [not null]
  type String [not null]
  customers customers [not null]
  products products [not null]
}

Table customers {
  id String [pk]
  createdAt DateTime [default: `now()`, not null]
  createdBy String
  updatedAt DateTime [not null]
  updatedBy String
  deletedAt DateTime
  deletedBy String
  name String [not null]
  code String [not null]
  storeCode String [not null]
  email String
  phone String
  birthday DateTime
  gender String
  note String [default: '']
  avatarId String
  avatar files
  store stores
  customerGroup customer_groups
  customerGroupId String
  customerInvoiceInfo customer_invoice_info
  invoices invoices [not null]

  indexes {
    (phone, storeCode) [unique]
    (email, storeCode) [unique]
    (code, storeCode) [unique]
  }
}

Table customer_invoice_info {
  buyerName String [not null]
  taxCode String [default: '']
  address String [default: '']
  province String [default: '']
  ward String [default: '']
  identityNumber String [default: '']
  email String [default: '']
  phone String [default: '']
  bankName String [default: '']
  bankAccount String [default: '']
  budgetUnitCode String [default: '']
  customer customers [not null]
  customerId String [unique, not null]
}

Table customer_groups {
  id String [pk]
  createdAt DateTime [default: `now()`, not null]
  createdBy String
  updatedAt DateTime [not null]
  updatedBy String
  deletedAt DateTime
  deletedBy String
  name String [not null]
  discountValue Float [default: 0]
  discountType String [default: 'VALUE']
  storeCode String [not null]
  store stores
  customers customers [not null]
}

Table transport_infos {
  invoiceId String [pk]
  weight Float [default: 0]
  length Float [default: 0]
  width Float [default: 0]
  height Float [default: 0]
  weightUnit String [default: 'gram']
  dimensionUnit String [default: 'cm']
  note String
  invoice invoices
}

Table delivery_infos {
  invoiceId String [pk]
  address String
  ward String
  district String
  province String
  note String
  invoice invoices
}

Table wards {
  code Int [pk]
  name String [not null]
  codeName String [not null]
  divisionType String [not null]
  shortCodeName String [not null]
  provinceCode Int [not null]
  province provinces [not null]
  branches branches [not null]
}

Table provinces {
  code Int [pk]
  name String [not null]
  divisionType String [not null]
  codeName String [not null]
  phoneCode String [not null]
  branches branches [not null]
  wards wards [not null]
}

Table BranchToUser {
  usersId String [ref: > users.id]
  branchesId String [ref: > branches.id]
}

Table RoleToUser {
  rolesId String [ref: > roles.id]
  usersId String [ref: > users.id]
}

Table ProductToProductLocation {
  productlocationsId String [ref: > stock_locations.id]
  productsId String [ref: > products.id]
}

Table FileToProduct {
  photosId String [ref: > files.id]
  productsId String [ref: > products.id]
}

Ref: branches.wardCode > wards.code [delete: Set Null]

Ref: branches.provinceCode > provinces.code [delete: Set Null]

Ref: branches.storeCode > stores.code [delete: Cascade]

Ref: users.storeCode > stores.code

Ref: permissions.roleId > roles.id [delete: Cascade]

Ref: permissions.groupCode > permission_groups.code

Ref: payment_methods.branchId > branches.id

Ref: invoices.(paymentMethodCode, branchId) > payment_methods.(code, branchId)

Ref: invoices.branchId > branches.id

Ref: invoices.customerId > customers.id

Ref: invoices.createdBy > users.id

Ref: invoices.updatedBy > users.id

Ref: invoice_items.productId > products.id [delete: Set Null]

Ref: invoice_items.invoiceId > invoices.id [delete: Cascade]

Ref: invoice_item_lots.invoiceItemId > invoice_items.id [delete: Cascade]

Ref: invoice_item_lots.productLotId > product_lots.id [delete: Cascade]

Ref: products.branchId > branches.id

Ref: products.manufacturerId > manufacturers.id

Ref: products.productGroupId > product_groups.id

Ref: products.parentId - products.id

Ref: product_groups.branchId > branches.id

Ref: product_groups.parentId - product_groups.id [delete: Set Null]

Ref: suppliers.supplierGroupId > supplier_groups.id

Ref: suppliers.branchId > branches.id

Ref: supplier_groups.branchId > branches.id

Ref: stock_transactions.supplierId > suppliers.id

Ref: stock_transactions.branchId > branches.id

Ref: stock_transactions.createdBy > users.id

Ref: stock_transactions.updatedBy > users.id

Ref: stock_items.productId > products.id

Ref: stock_items.transId > stock_transactions.id [delete: Cascade]

Ref: stock_item_lots.stockItemId > stock_items.id [delete: Cascade]

Ref: stock_item_lots.productLotId > product_lots.id [delete: Cascade]

Ref: product_lots.branchId > branches.id

Ref: product_lots.productId > products.id

Ref: stock_cards.productId > products.id

Ref: stock_cards.transId > stock_transactions.id

Ref: stock_locations.branchId > branches.id

Ref: product_weights.productId - products.id

Ref: medicine_infos.productId - products.id

Ref: medicine_infos.routeId > medicine_routes.id [delete: Set Null]

Ref: medicine_routes.branchId > branches.id

Ref: manufacturers.branchId > branches.id

Ref: customers.avatarId > files.id

Ref: customers.storeCode > stores.code [delete: Set Null]

Ref: customers.customerGroupId > customer_groups.id

Ref: customer_invoice_info.customerId - customers.id [delete: Cascade]

Ref: customer_groups.storeCode > stores.code [delete: Set Null]

Ref: transport_infos.invoiceId - invoices.id

Ref: delivery_infos.invoiceId - invoices.id

Ref: wards.provinceCode > provinces.code